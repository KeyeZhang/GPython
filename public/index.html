<!DOCTYPE html>



<html>

<head>
 <meta charset="UTF-8">


<style>
.myholder {
  width: 800px;
  height: 800px;
  border-top: 2px solid black;
  border-bottom: 2px solid black;


}

</style>
<title> this fucking library</title>
<link rel = "stylesheet" type = "text/css" href = "/stylesheets/joint.css" />
<link rel = "stylesheet" type = "text/css" href = "/stylesheets/mycss.css"/>
<script src = "/javascripts/jquery.min.js"></script>
<script src = "/javascripts/lodash.min.js"></script>
<script src = "/javascripts/backbone-min.js"></script>
<script src = "/javascripts/joint.js"></script>
<!--
<script src = "js/joint.shapes.devs.js"> </script> -->
<script src = "/javascripts/joint.shapes.devs.js"></script>
<!-- <script src = "js/joint.shapes.devs.min.js"></script> -->



</head>


<body>

<div class = "head">
  <div class = "fonts">
    <p> This is an interactive graphing tool for running Python scripts and analyzing data </p>
  </div>
  <!-- <p> This is an interactive graphing tool for running Python scripts and analyzing data </p> -->
</div>



<div class = "container">


  <div>
    <form action = "/scatterRegression_0.png" method = "GET">


      <input type ="submit" name = "why" value = "show the first regression result"/>

    </form>


    <form action = "/scatterRegression_1.png" method = "GET">

      <input type ="submit" name = "why" value = "show the second regression result"/>

    </form>

    <form name = "python" method = "POST">
      <input type = "submit" value = "Run"/>
    </form>

    <form method = "POST" action ="/file_upload" enctype="multipart/form-data">
      <input type = "file" name = "file" size = "50" />
      <br />
      <input type = "submit" value = "Upload File"/>
    </form>
  </div>





<div id="paper" class = "paper"></div>
<div id = "myholder"></div>


<script>






var graph = new joint.dia.Graph;
var paper = new joint.dia.Paper({
    el: $('#paper'),
    width: 800, height: 800, gridSize: 1,
    model: graph,
    background: {
       color: '#e6e6e6'
    },
    defaultLink: new joint.dia.Link({
        attrs: { '.marker-target': { d: 'M 10 0 L 0 5 L 10 10 z' } }
    }),
    validateConnection: function(cellViewS, magnetS, cellViewT, magnetT, end, linkView) {
        // Prevent linking from input ports.
        if (magnetS && magnetS.getAttribute('type') === 'input') return false;
        // Prevent linking from output ports to input ports within one element.
        if (cellViewS === cellViewT) return false;
        // Prevent linking to input ports.
        return magnetT && magnetT.getAttribute('type') === 'input';
    },
    // validateMagnet: function(cellView, magnet) {
    //     // Note that this is the default behaviour. Just showing it here for reference.
    //     // Disable linking interaction for magnets marked as passive (see below `.inPorts circle`).
    //     return magnet.getAttribute('magnet') !== 'passive';
    // }
    validateConnection: function(sourceView, sourceMagnet, targetView, targetMagnet) {

        return sourceMagnet != targetMagnet;
    }
});


paper.on('blank:pointerdown', function(element, ev, x,y){
  const name  = prompt("please enter the name of the node");
  document.python.action = name;
  console.log("had found");
  var cell = new joint.shapes.devs.Model({
    position:{x:250, y:300},
    size: {width: 120, height: 100},
    inPorts: ['in1'],
    outPorts: ['out1', 'out2'],
    attrs: {
      '.label': {text: name, 'ref-x':.4, 'ref-y': .2},
      rect: {fill: 'green'},
      '.inPorts circle': { fill: '#16A085', type: 'input' },
      '.outPorts circle': { fill: '#E74C3C', type: 'output' }
    }
  });
  graph.addCell(cell);
  console.log("ll");
  console.log(cell.prop('attrs')['.label'].text);

});

paper.on('cell:pointerclick', function(element, ev, x,y){
  var cell = element.model;
  const string = cell.prop('attrs')['.label'].text;
  document.python.action = string;
  document.python.submit();
});


paper.on('cell:contextmenu', function(element, ev, x, y){
  var name = prompt("please enter the link name");
})



</script>

</div>

<div class = "footer">
    <p> Author: Bowen Song, Jiayin Lu     Special Thanks: Dr.Kind </p>
    <p> We are math students from UIUC </p>
</div>





</body>


</html>
